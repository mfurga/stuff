#include <stdio.h>
#include <stdlib.h>
#include <unistd.h>

#define BUF_SIZE 64

void secret_func(void) {
  puts("Secret func ;O");
  exit(1);
}

void vuln(const char *buf) {
  /* vuln */
  printf(buf);

  /* debug */
  void *ret_addr = __builtin_return_address(0);
  void *frame_addr = __builtin_frame_address(0);
  printf("buf: %p\n", buf);
  printf("secret_func: %p\n", secret_func);
  printf("frame: %p\n", frame_addr);
  printf("ret: %p\n", ret_addr);
}

int main(int argc, char **argv) {
  char buf[512];
  read(0, buf, sizeof(buf));

  vuln(buf);

  return 0;
}
