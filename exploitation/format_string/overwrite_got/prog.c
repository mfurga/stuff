#include <stdio.h>
#include <stdlib.h>
#include <unistd.h>

#define BUF_SIZE 64

void secret_func(void) {
  puts("Secret func ;O");
  _exit(1);
}

void vuln(const char *buf) {
  /* vuln */
  printf(buf);

  /* debug */
  printf("\nDEBUG INFO:\n");
  printf("secret_func: %p\n", secret_func);
  printf("exit@GOT: 0x%lx\n", *(size_t *)(0x404038));

  exit(0);
}

int main(int argc, char **argv) {
  char buf[512];
  read(0, buf, sizeof(buf));

  vuln(buf);

  return 0;
}
